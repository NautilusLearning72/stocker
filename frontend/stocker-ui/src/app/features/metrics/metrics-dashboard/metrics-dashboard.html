<div class="metrics-dashboard mx-auto max-w-6xl space-y-8">
  <!-- Page Header -->
  <div class="page-header flex flex-wrap items-center justify-between gap-4">
    <h1 class="page-title flex items-center gap-2 text-xl font-semibold text-text">
      <mat-icon class="text-accent">analytics</mat-icon>
      Metrics Dashboard
    </h1>

    <div class="header-controls flex flex-wrap items-center gap-3">
      <!-- Time Range Selector -->
      <mat-form-field appearance="outline" class="time-select w-full sm:w-40">
        <mat-label>Time Range</mat-label>
        <mat-select [(ngModel)]="selectedHours" (selectionChange)="onTimeRangeChange()">
          <mat-option *ngFor="let opt of hourOptions" [value]="opt.value">
            {{ opt.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Real-time Toggle -->
      <div class="live-toggle flex items-center gap-2 rounded-full border border-border bg-canvas-subtle px-3 py-1 text-sm text-muted">
        <mat-slide-toggle
          [(ngModel)]="isLive"
          (change)="onLiveToggle()"
          color="primary">
          Live
        </mat-slide-toggle>
        <span class="connection-indicator flex items-center" [ngClass]="connectionStatus">
          <mat-icon *ngIf="connectionStatus === 'connected'">wifi</mat-icon>
          <mat-icon *ngIf="connectionStatus === 'connecting'" class="spinning">sync</mat-icon>
          <mat-icon *ngIf="connectionStatus === 'disconnected'">wifi_off</mat-icon>
        </span>
      </div>

      <!-- Refresh Button -->
      <button
        mat-icon-button
        (click)="refresh()"
        [disabled]="loadingSummary || loadingEvents"
        matTooltip="Refresh data">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>
  </div>

  <!-- Summary Section -->
  <section class="section summary-section">
    <div class="section-header space-y-1">
      <h2 class="text-lg font-semibold text-text">System Activity Overview</h2>
      <p class="help-text flex flex-wrap items-center gap-1 text-sm text-muted">
        Key metrics showing what the trading system has been doing. Hover over the
        <mat-icon class="inline-icon">help_outline</mat-icon> icons for explanations.
      </p>
    </div>
    <mat-card>
      <mat-card-content>
        <app-metrics-summary
          [summary]="summary"
          [loading]="loadingSummary">
        </app-metrics-summary>
      </mat-card-content>
    </mat-card>
  </section>

  <!-- Event Feed Section -->
  <section class="section events-section">
    <div class="section-header space-y-1">
      <h2 class="text-lg font-semibold text-text">Event Feed</h2>
      <p class="help-text flex flex-wrap items-center gap-1 text-sm text-muted">
        Detailed log of individual events. Use filters to focus on specific categories or symbols.
        Hover over event names for descriptions.
      </p>
    </div>
    <mat-card>
      <mat-card-content>
        <app-event-feed
          [events]="events"
          [loading]="loadingEvents"
          [isLive]="isLive"
          (filtersChanged)="onFiltersChange($event)">
        </app-event-feed>
      </mat-card-content>
    </mat-card>
  </section>
</div>
